<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Coroutine [Facets More API]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <div class='name'>
          <span class='type'>Class</span>
          Coroutine
        </div>
        <ol class='paths'>
          <li>
            <a href="../files/lib/more/facets/coroutine_rb.html">lib/more/facets/coroutine.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <h1><a href="Coroutine.html">Coroutine</a></h1>
            <p>
            Coroutines are program components like subroutines. Coroutines are more
            generic and flexible than subroutines, but are less widely used in
            practice. Coroutines were first introduced natively in Simula. Coroutines
            are well suited for implementing more familiar program components such as
            cooperative tasks, iterators, infinite lists, and pipes.
            </p>
            <p>
            This mixin solely depends on method read(n), which must be defined in the
            class/module where you mix in this module.
            </p>
            <h2>Usage</h2>
            <pre>count = (ARGV.shift || 1000).to_i&#x000A;input = (1..count).map { (rand * 10000).round.to_f / 100}&#x000A;&#x000A;Producer = Coroutine.new do |me|&#x000A;  loop do&#x000A;    1.upto(6) do&#x000A;      me[:last_input] = input.shift&#x000A;      me.resume(Printer)&#x000A;    end&#x000A;    input.shift # discard every seventh input number&#x000A;  end&#x000A;end&#x000A;Printer = Coroutine.new do |me|&#x000A;  loop do&#x000A;    1.upto(8) do&#x000A;      me.resume(Producer)&#x000A;      if Producer[:last_input]&#x000A;        print Producer[:last_input], &quot;\t&quot;&#x000A;        Producer[:last_input] = nil&#x000A;      end&#x000A;      me.resume(Controller)&#x000A;    end&#x000A;    puts&#x000A;  end&#x000A;end&#x000A;&#x000A;Controller = Coroutine.new do |me|&#x000A;  until input.empty? do&#x000A;    me.resume(Printer)&#x000A;  end&#x000A;end&#x000A;&#x000A;Controller.run</pre>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000231">new</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000236">[]</a></li>
              <li><a href="#M000237">[]=</a></li>
              <li><a href="#M000234">resume</a></li>
              <li><a href="#M000232">run</a></li>
              <li><a href="#M000233">stop</a></li>
            </ol>
            <h3>protected instance</h3>
            <ol>
              <li><a href="#M000235">continue</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>stopped</td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='public-class method' id='method-M000231'>
                <a name='M000231'>      </a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(data = {}) {|self| ...}</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000231-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000231-source'><span class="ruby-comment cmt"># File lib/more/facets/coroutine.rb, line 115</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">data</span> = {})&#x000A;    <span class="ruby-ivar">@stopped</span> = <span class="ruby-keyword kw">nil</span>&#x000A;    <span class="ruby-ivar">@data</span> = <span class="ruby-identifier">data</span>&#x000A;    <span class="ruby-identifier">callcc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-ivar">@continue</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-keyword kw">return</span>&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span>&#x000A;    <span class="ruby-identifier">stop</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000236'>
                <a name='M000236'>      </a>
                <div class='synopsis'>
                  <span class='name'>[]</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000236-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000236-source'><span class="ruby-comment cmt"># File lib/more/facets/coroutine.rb, line 148</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">name</span>)&#x000A;    <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">name</span>]&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000237'>
                <a name='M000237'>      </a>
                <div class='synopsis'>
                  <span class='name'>[]=</span>
                  <span class='arguments'>(name, value)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000237-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000237-source'><span class="ruby-comment cmt"># File lib/more/facets/coroutine.rb, line 152</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)&#x000A;    <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">value</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000234'>
                <a name='M000234'>      </a>
                <div class='synopsis'>
                  <span class='name'>resume</span>
                  <span class='arguments'>(other)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000234-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000234-source'><span class="ruby-comment cmt"># File lib/more/facets/coroutine.rb, line 137</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">resume</span>(<span class="ruby-identifier">other</span>)&#x000A;    <span class="ruby-identifier">callcc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-ivar">@continue</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">other</span>.<span class="ruby-identifier">continue</span>(<span class="ruby-keyword kw">self</span>)&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000232'>
                <a name='M000232'>      </a>
                <div class='synopsis'>
                  <span class='name'>run</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000232-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000232-source'><span class="ruby-comment cmt"># File lib/more/facets/coroutine.rb, line 127</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run</span>&#x000A;    <span class="ruby-identifier">callcc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-ivar">@stopped</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">continue</span>&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000233'>
                <a name='M000233'>      </a>
                <div class='synopsis'>
                  <span class='name'>stop</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000233-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000233-source'><span class="ruby-comment cmt"># File lib/more/facets/coroutine.rb, line 133</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stop</span>&#x000A;    <span class="ruby-ivar">@stopped</span>.<span class="ruby-identifier">call</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Protected instance methods</h2>
              <div class='protected-instance method' id='method-M000235'>
                <a name='M000235'>      </a>
                <div class='synopsis'>
                  <span class='name'>continue</span>
                  <span class='arguments'>(from = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000235-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000235-source'><span class="ruby-comment cmt"># File lib/more/facets/coroutine.rb, line 143</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">continue</span>(<span class="ruby-identifier">from</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;    <span class="ruby-ivar">@stopped</span> = <span class="ruby-identifier">from</span>.<span class="ruby-identifier">stopped</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@stopped</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">from</span>&#x000A;    <span class="ruby-ivar">@continue</span>.<span class="ruby-identifier">call</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
